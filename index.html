<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard by Rizky Alde</title>
  <style>
    /* Gaya CSS untuk elemen tanggal */
    #tanggal {
      position: absolute;
      bottom: 10px;
      left: 10px;
      font-size: 14px;
      color: #333; /* Warna teks */
    }
  </style>
</head>
<body>

<!-- Elemen Tanggal -->
<div id="tanggal"></div>

<div class="tableauPlaceholder" id="viz1699160449301" style="position: relative">
  <noscript>
    <a href="#">
      <img
        alt="Overview (2)"
        src="https://public.tableau.com/static/images/DA/DASHBOARDANALISASTATISTIKATERAPANPROJECT4/Overview2/1_rss.png"
        style="border: none"
      />
    </a>
  </noscript>
  <object class="tableauViz" style="display: none">
    <param name="host_url" value="https%3A%2F%2Fpublic.tableau.com%2F" />
    <param name="embed_code_version" value="3" />
    <param name="site_root" value="" />
    <param
      name="name"
      value="DASHBOARDANALISASTATISTIKATERAPANPROJECT4/Overview2"
    />
    <param name="tabs" value="no" />
    <param name="toolbar" value="yes" />
    <param
      name="static_image"
      value="https://public.tableau.com/static/images/DA/DASHBOARDANALISASTATISTIKATERAPANPROJECT4/Overview2/1.png"
    />
    <param name="animate_transition" value="yes" />
    <param name="display_static_image" value="yes" />
    <param name="display_spinner" value="yes" />
    <param name="display_overlay" value="yes" />
    <param name="display_count" value="yes" />
    <param name="language" value="en-US" />
    <param name="filter" value="publish=yes" />
  </object>
</div>

<script type="text/javascript">
  var divElement = document.getElementById("viz1699160449301");
  var vizElement = divElement.getElementsByTagName("object")[0];
  vizElement.style.width = "1600px";
  vizElement.style.height = "927px";

  var scriptElement = document.createElement("script");
  scriptElement.src = "https://public.tableau.com/javascripts/api/viz_v1.js";
  vizElement.parentNode.insertBefore(scriptElement, vizElement);

  // Tambahkan logika untuk mengatur filter atau parameter
  function onFirstInteractive() {
    var workbook = viz.getWorkbook();
    var activeSheet = workbook.getActiveSheet();

    // Contoh: Menambahkan filter dinamis
    activeSheet.applyFilterAsync("Category", ["Technology"], tableau.FilterUpdateType.REPLACE);

    // Contoh: Menambahkan parameter
    var parameterName = "Region";
    var parameterValue = "East";
    workbook.changeParameterValueAsync(parameterName, parameterValue);

    // Contoh: Mengubah warna latar belakang dashboard
    var dashboard = viz.getWorkbook().getPublishedSheets()[0].getWorksheets()[0].getDashboard();
    var backgroundColor = {
      r: 255, // nilai merah (0-255)
      g: 0,   // nilai hijau (0-255)
      b: 0    // nilai biru (0-255)
    };
    dashboard.changeParameterValueAsync("BackgroundColor", backgroundColor);

    // Tambahkan elemen tanggal
    var currentDate = new Date();
    var formattedDate = currentDate.toLocaleDateString();
    document.getElementById("tanggal").innerText = formattedDate;
  }

  // Menunggu hingga visualisasi siap
  scriptElement.onload = function () {
    var viz = new tableau.Viz(vizElement, "DASHBOARD_URL", { hideTabs: true, onFirstInteractive: onFirstInteractive });
  };
</script>

</body>
</html>
